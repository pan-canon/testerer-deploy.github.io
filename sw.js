(()=>{importScripts("https://storage.googleapis.com/workbox-cdn/releases/6.5.4/workbox-sw.js");const{setCacheNameDetails:e,clientsClaim:a}=workbox.core,{precacheAndRoute:t,cleanupOutdatedCaches:s}=workbox.precaching,{registerRoute:c,createHandlerBoundToURL:n}=workbox.routing,{CacheFirst:i,StaleWhileRevalidate:l}=workbox.strategies,{ExpirationPlugin:o}=workbox.expiration;e({prefix:"",suffix:"",precache:"game-cache-v60",runtime:""}),s(),t([{'revision':'818c40f636aafdfe78423b4a97857386','url':'assets/audio/ghost_effect.mp3'},{'revision':'5eea9745e96438be42a4b41287302abe','url':'assets/audio/type_sound.mp3'},{'revision':'3315ad1395950358c1348af8d6fddc14','url':'assets/images/pencil.png'},{'revision':'94af2da223a34929b7a8dfa32f63e03a','url':'assets/images/static-image.webp'},{'revision':'4afa1e003c672007562c985ad45bc7da','url':'config/chatDialogueConfig.json'},{'revision':'ab4beacaec3c0509895c0caf9ccd8bbc','url':'config/detectableItems.js'},{'revision':'2835543154e05172c13bccc85c7bb2a2','url':'config/gameEntities.json'},{'revision':'565648aa78ce68c226dca843236a25c0','url':'config/paths.js'},{'revision':'beb2c87d7101736f8b9578a9b11c4548','url':'config/stateKeys.js'},{'revision':'84836f9cb7405ee45b7bcd605ea5bcf7','url':'index.html'},{'revision':'8108a91c0f4a7d5985b77da7fc960504','url':'main.min.js'},{'revision':'cc5977edba3dbe1cd90c5e3756a831c3','url':'manifest.json'},{'revision':'6da348be08c96b7fcd736702e57b8276','url':'templates/apartment-plan-screen_template.html'},{'revision':'67c181eb4e93c776a26ddfb59b3f11ee','url':'templates/chat_template.html'},{'revision':'a73352fea6918e4e91cb79097102c83c','url':'templates/diaryentry_screen-template.html'},{'revision':'c9e68d9e1f2ca2d0d028f8d7943b4a3c','url':'templates/landing-screen_template.html'},{'revision':'563d05cc19c882133f377a7b7d4aeb9e','url':'templates/main-screen_template.html'},{'revision':'aa5d331069d649e19bb6a0002086160e','url':'templates/registration-screen_template.html'},{'revision':'ba9f2deea5d3a6e06b76d9bded0c93e6','url':'templates/selfie-screen_template.html'}]),a(),self.addEventListener("install",(e=>{console.log("[SW] install → notifying clients about new version"),e.waitUntil(self.clients.matchAll({includeUncontrolled:!0}).then((e=>{e.forEach((e=>e.postMessage({type:"NEW_VERSION_AVAILABLE",persistent:!0})))})))}));const r=["game-cache-v60","cache-libs","cache-models","cache-triads","cache-statics","cache-modules","cache-templates"];self.addEventListener("activate",(e=>{console.log("[SW] activate → cleaning up old caches"),e.waitUntil(caches.keys().then((e=>Promise.all(e.filter((e=>!r.includes(e))).map((e=>(console.log(`[SW] deleting cache: ${e}`),caches.delete(e))))))).then((()=>(console.log("[SW] claim clients after cleanup"),self.clients.claim()))))})),self.addEventListener("message",(e=>{const a=e.data||{};return"SKIP_WAITING"===a.type?(console.log("[SW] SKIP_WAITING received → activating new SW"),void e.waitUntil(self.skipWaiting().then((()=>self.clients.claim())))):"CLEAR_CACHE"===a.action?(console.log("[SW] CLEAR_CACHE received → purging all caches"),void e.waitUntil(caches.keys().then((e=>Promise.all(e.map((e=>(console.log(`[SW] removing cache: ${e}`),caches.delete(e))))))).then((()=>self.clients.matchAll())).then((e=>{e.forEach((e=>{console.log(`[SW] reloading client: ${e.url}`),e.navigate(e.url)}))})))):void 0})),c((({url:e})=>e.pathname.startsWith("/assets/libs/")),new i({cacheName:"cache-libs",plugins:[new o({maxEntries:20,maxAgeSeconds:2592e3})]})),c((({url:e})=>e.pathname.startsWith("/assets/models/")),new i({cacheName:"cache-models",plugins:[new o({maxEntries:15,maxAgeSeconds:2592e3})]})),c((({url:e})=>e.pathname.startsWith("/triads/")),new i({cacheName:"cache-triads",plugins:[new o({maxEntries:50,maxAgeSeconds:2592e3})]})),c((({url:e})=>e.pathname.startsWith("/assets/images/")||/\.(?:png|jpe?g|webp|gif|svg|mp3|wav|ogg|json)$/.test(e.pathname)),new l({cacheName:"cache-statics",plugins:[new o({maxEntries:100,maxAgeSeconds:7776e3})]})),c((({url:e})=>e.pathname.endsWith(".js")),new l({cacheName:"cache-modules",plugins:[new o({maxEntries:30,maxAgeSeconds:2592e3})]})),c((({url:e})=>e.pathname.startsWith("/templates/")&&e.pathname.endsWith(".html")),new l({cacheName:"cache-templates",plugins:[new o({maxEntries:50,maxAgeSeconds:2592e3})]})),c((({request:e})=>"navigate"===e.mode),n("/index.html"))})();